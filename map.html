<!DOCTYPE html>
<html>
<head>
    <title>GitHub Repositories</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sigma.js/1.2.1/sigma.min.js"></script>
    <style>
        #container {
            max-width: 800px;
            height: 600px;
            margin: auto;
            border: none;
        }
        #info {
            position: absolute;
            background-color: #fff;
            padding: 10px;
            /* border-radius: 5px; */
            border: none;
            display: none;
            z-index: 100;
            pointer-events: none;
            width: 400px;
            height: 300px;
        }
        #search {
            position: absolute;
            top: 10px;
            right: 10px;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="info">
        <iframe id="infoFrame" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>
    <input id="search" type="text" placeholder="Search...">
    <script>
        const s = new sigma({
            graph: { nodes: [], edges: [] },
            container: 'container',
            settings: {
                defaultLabelColor: '#000',
                defaultLabelSize: 14,
                defaultLabelBGColor: '#ddd',
                defaultHoverLabelBGColor: '#002147',
                defaultLabelHoverColor: '#fff',
                labelThreshold: 6,
                defaultEdgeType: 'arrow'
            }
        });
        const info = document.getElementById('info');
        const infoFrame = document.getElementById('infoFrame');
        const search = document.getElementById('search');

        fetch('https://api.github.com/orgs/target-ops/repos')
            .then(response => response.json())
            .then(data => {
                s.graph.addNode({
                    id: 'n0',
                    label: 'target-ops',
                    x: 0.5,
                    y: 0.5,
                    size: 2,
                    color: '#000'
                });

                data.forEach((repo, i) => {
                    s.graph.addNode({
                        id: 'n' + (i + 1),
                        label: repo.name,
                        x: Math.random(),
                        y: Math.random(),
                        size: 1,
                        color: '#69b3a2'
                    });

                    s.graph.addEdge({
                        id: 'e' + i,
                        source: 'n0',
                        target: 'n' + (i + 1),
                        color: '#ccc'
                    });
                });

                s.refresh();
            });

        s.bind('clickNode', function(e) {
            window.open('https://github.com/target-ops/' + e.data.node.label, '_blank');
        });

        s.bind('overNode', function(e) {
            info.style.display = 'block';
            infoFrame.src = 'https://target-ops.github.io/' + e.data.node.label;
            info.style.left = e.data.captor.clientX + 'px';
            info.style.top = e.data.captor.clientY + 'px';
        });

        s.bind('outNode', function() {
            info.style.display = 'none';
        });

        search.addEventListener('input', function() {
            const query = this.value.toLowerCase();
            s.graph.nodes().forEach(function(n) {
                n.hidden = n.label.toLowerCase().indexOf(query) === -1;
            });
            s.refresh();
        });
    </script>
</body>
</html>



